function islowercase(r){return r>="a"&&"z">=r}function isuppercase(r){return r>="A"&&"Z">=r}function isdigit(r){return r>="0"&&"9">=r}function isspecial(r){return"-"==r||"+"==r}function formula_from_str(r){for(var e={},i="",n="",s=0,t=r.length;t>s;s++){var a=r[s];isuppercase(a)||isspecial(a)?(i.length>0&&(e[i]||(e[i]=0),e[i]+=n.length>0?parseInt(n):1),i=isuppercase(a)?a:"",n=""):islowercase(a)?i+=a:isdigit(a)&&(n+=a)}return i.length>0&&(e[i]||(e[i]=0),e[i]+=n.length>0?parseInt(n):1),e}function exact_mass(r){var e=formula_from_str(r),i=0;for(var n in e){if(!MASS_LIST[n])return-1;i+=e[n]*MASS_LIST[n]}return i}function MZ_RANGE(r,e){return{min:r*(1-1e-6*e),max:r*(1+1e-6*e)}}var MASS_LIST={H:1.007825,"H*":2.014102,B:11.009305,C:12,"C*":13.003355,Cl:34.968853,N:14.003074,"N*":15.000109,O:15.994915,F:18.998403,P:30.973763,S:31.972072,U:22.98977,Br:78.918336,I:126.904477},PROTON_MASS=1.00727647,C_NEUTRON_MASS=MASS_LIST["C*"]-MASS_LIST.C;
