
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <title>Documentation Site</title>

    <style>
        /* Google Font Import */
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
    
        body, html {
            height: 100%; /* Ensure the full height */
            margin: 0;
            padding: 0;
            display: flex;
            font-family: 'Roboto', sans-serif;
        }
    
        #wrapper {
            display: flex;
            width: 100%; /* Full width of the viewport */
        }
    
        #sidebar {
            display: flex;
            flex-direction: column;
            width: 30%; /* Set sidebar to 30% of the viewport width */
            background: #2c3e50; /* Darker shade for sidebar */
            color: #fff;
            padding: 20px;
            height: 100vh; /* Full height of the viewport */
            box-sizing: border-box; /* Include padding in width */
        }
    
        .sidebar-list {
            list-style: none;
            padding: 0;
        }
    
        .sidebar-item a {
            color: #fff;
            text-decoration: none;
            display: block;
            padding: 10px;
            border-radius: 4px;
            transition: background-color 0.3s, color 0.3s;
        }
    
        .sidebar-item a:hover, .sidebar-item a:focus {
            background-color: #34495e;
            color: #ecf0f1; /* Light color on hover */
        }
    
        #content {
            flex-grow: 1;
            padding: 20px;
            background-color: #ffffff; /* White background for content */
            overflow-y: auto; /* Scroll if content overflows */
        }
    
        /* Code Text Styling */
        code {
            background-color: #ffffff;
            color: #c0392b; /* Dark red color for code */
            padding: 2px 4px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
    
        /* Section Styling */
        section h1 {
            color: #19547c; /* Blue color for headings */
        }

        section h3 {
            color: #418bbd; /* Blue color for headings */
        }
    
        /* Sub-section */
        .sub-section a {
            color: #c4cbcc; /* Subtle color for sub-section links */
        }
    
        .sub-section a:hover {
            color: #d0dedf;
        }
    
       
    </style>
</head>
<body>
    <div id="wrapper">
        <nav id="sidebar">
            <ul class="sidebar-list">
                <li class="sidebar-item">
                    <a href="#home" onclick="toggleSections('home'); toggleSubsections('home-subsections')">Home</a>
                </li>

                <li class="sidebar-item">
                    <a href="#local-server-config" onclick="toggleSections('local-server-config-body'); toggleSubsections('local-server-config-subsections')">Local Server Configuration</a>
                    <ul id="local-server-config-subsections" class="sub-section">
                        <li><a href="#local-server-config-mac">Mac and Linux</a></li>
                        <li><a href="#local-server-config-windows">Windows</a></li>
                    </ul>
                </li>

                <li class="sidebar-item">
                    <a href="#local-server-run" onclick="toggleSections('local-server-run-body'); toggleSubsections('local-server-run-subsections')">Run, Stop, and Update a Local Server</a>
                    <ul id="local-server-run-subsections" class="sub-section">
                        <li><a href="#local-server-run-mac">Mac and Linux</a></li>
                        <li><a href="#local-server-run-windows">Windows</a></li>
                    </ul>
                </li>

                <li class="sidebar-item">
                    <a href="#upload-data" onclick="toggleSections('upload-data'); toggleSubsections('upload-data-subsections')">Uploading Data</a>
                    <ul id="upload-data-subsections" class="sub-section">
                        <li><a href="#upload-data-pool">Metabolomics Pool Data</a></li>
                        <li><a href="#upload-data-iso">Metabolomics Isotopologue Data</a></li>
                        <li><a href="#upload-data-lingress">External Variable Data for Linear Regression with Metabolomics</a></li>
                    </ul>
                </li>

                <li class="sidebar-item">
                    <a href="#getting-started" onclick="toggleSections('getting-started'); toggleSubsections('getting-started-subsections')">Getting Started</a>
                    <ul id="getting-started-subsections" class="sub-section">
                        <li><a href="#getting-started-classes">Metabolite Classes</a></li>
                        <li><a href="#getting-started-normalization">Pool Data Normalization</a></li>
                        <li><a href="#getting-started-groups">Sample Groups and Order</a></li>
                    </ul>
                </li>

                <li class="sidebar-item">
                    <a href="#analysis-graphs" onclick="toggleSections('analysis-graphs'); toggleSubsections('analysis-graphs-subsections')">Analysis Graphs</a>
                    <ul id="analysis-graphs-subsections" class="sub-section">
                        <li><a href="#analysis-graphs-bulk-heatmap">Bulk Heatmap</a></li>
                        <li><a href="#analysis-graphs-bulk-iso-heatmap">Bulk Isotopologue Heatmap</a></li>
                        <li><a href="#analysis-graphs-custom-heatmap">Custom Heatmap</a></li>
                        <li><a href="#analysis-graphs-bulk-metabolomics">Bulk Metabolomics</a></li>
                        <li><a href="#analysis-graphs-iso-distribution">Isotopologue Distribution</a></li>
                        <li><a href="#analysis-graphs-volcano">Volcano Plot</a></li>
                        <li><a href="#analysis-graphs-lingress">Linear Regression</a></li>
                    </ul>
                </li>
            </ul>
        </nav>

        <div id="content">
            <section id="home">
                <h1>Christofk_Grapha Tutorial / Documentation</h1>
                <p>
                    Welcome to documentation on how to use Christofk_Grapha. This is an automated 
                    visualization and data analysis tool for metabolomics data from Christofk Lab 
                    at UCLA. Please reach out to Nedas Matulionis at 
                    <a href="mailto:nmatulionis@mednet.ucla.edu">nmatulionis@mednet.ucla.edu</a> 
                    if you have any questions.
                    <br><br>
                    Please note that this is a new effort by the Christofk lab to visualize metabolomics 
                    data after LC/MS peak analysis and metabolite name assignment.
                    If you have any issues with using the Christofk_Grapha tool, please reach out to 
                    Nedas Matulionis at 
                    <a href="mailto:nmatulionis@mednet.ucla.edu">nmatulionis@mednet.ucla.edu</a> 
                    , so that we can address your issue.
                    

                </p>
            </section>

            <section id="local-server-config-body">
                <h1>Non-UCLA Local Server Configuration</h1>
                <p>
                    We are planning to release Christofk_Grapha on UCLA server where a user that has a 
                    UCLA login, will be able to directly login and use this tool. 
                    <br><br>
                    For non UCLA users and while we await UCLA server configuration, it is possible to 
                    run a Flask server on your local machine.
                    Please be aware that some parts are operating system specific.
                    <br><br>
                    <b>Note that you only need to do the configuration once!</b>

                    <ol>
                        <li>
                            If you do not have Python on your computer, go to 
                            <a href="https://www.python.org/downloads/release/python-3120/" target="_blank">Python 3.12 download website</a>
                             and download the installer for Python 3.12 for your operating system.
                            <ul>
                                <li>
                                    If the computer is a UCLA computer, please let me know and we can work on installing this together.
                                </li>
                                <li>
                                    <b>For Windows users,</b> when installing, please check the box that says: 
                                    “Add Python to PATH variables”.
                                </li>
                                <li><b>For Mac or Linux users,</b> after Python is installed, go to Applications &gt;
                                     Python 3.12 and double click on two files in this order:
                                     Install Certificates.command; Update Shell Profile.command.
                                </li>
                            </ul>
                        </li>
                        <br>
                        <li>Go to <a href="https://github.com/EnEmz/Christofk_Grapha" target="_blank">Chrisofk_Grapha github repository</a>, 
                            click on green "Code" button and click "Download Zip".
                        </li>
                        <br>
                        <li>Locate the Chrisofk_Grapha zip file in your downloads folder (extract it for Windows users)
                            and put the folder on your Desktop. <b>Make sure the folder name is 
                            "Chrisofk_Grapha" on the Desktop.</b> You will need to <b>delete "-main"</b>.
                        </li>
                    </ol>
                    You have all the files ready for running the automated scripts for starting a 
                    local server on your computer. 
                    Now let's set up the scripts to be able to run for your computer:
                    <br><br>
                </p>
            
                <section id="local-server-config-mac">
                    <h3>Mac and Linux</h3>
                    <p>
                        <ol>
                            <li>
                                Press Command + Space, type “terminal”, press Enter to open the Terminal.
                            </li>
                            <br>
                            <li>
                                Type and be aware of spaces: <code>cd Desktop/Christofk_Grapha/scripts</code>, 
                                click Enter to change your active terminal directory to the app's folder where the scripts are located.
                                <ul>
                                    <li>At any point in the Terminal, if you want to see what is inside your current directory you can type <code>ls</code> and press Enter.</li>
                                </ul>
                            </li>
                            <br>
                            <li>
                                Now we need to change the command scripts (automated terminal commands) to executable files so that it's possible to run them on your computer. 
                                While in <code>/Christofk_Grapha/scripts</code> folder directory in the terminal, execute two commands:
                                <ul>
                                    <li>Type <code>chmod +x control_app_mac.command</code> and press <code>Enter</code></li>
                                    <li>Type <code>chmod +x setup_mac_linux.command</code> and press <code>Enter</code></li>
                                </ul>
                            </li>
                            <br>
                            This is all the more complicated interaction with the terminal we are going to need, I promise.<br>
                            <br>
                            <li>
                                Now we can setup the environment for the app to be able to run. We only need to do this once to set it up for your computer.
                                <ul>
                                    <li>
                                        Go to your Desktop, open the <code>Christofk_Grapha/scripts</code> folder and double click on <code>setup_mac_linux.command</code> file.
                                        Due to Mac security features in newer OS, this might give you a security message. Try right-click on the 
                                        <code>setup_mac_linux.command</code> file and click <code>Open</code>.
                                    </li>
                                    <li>This should result in a lot of text. We are installing the necessary Python packages to a virtual Python environment for Christofk_Grapha.
                                        At the end of the file you should see a message <code>[Process completed]</code> after which you can close the terminal.
                                    </li>
                                </ul>
                            </li>
                        </ol>
                        <b>Note that you only need to do the configuration once!</b>
                        <br>
                    </p>
                </section>
            
                <section id="local-server-config-windows">
                    <h3>Windows</h3>
                    <p>
                        <ol>
                            <li>
                                Go to your <code>Desktop/Christofk_Grapha/scripts</code> folder and double click on the <code>setup_windows.bat</code> file. 
                                    <ul>
                                        <li>If you receive a warning message, click on <code>More info</code> and on <code>Run anyway</code>.</li>
                                    </ul>
                            </li>
                            <br>
                            <li>
                                Please wait for the computer to create a virtual environment and install necessary Python packages, 
                                this process might take 10 minutes or more depending on your computer and internet speed.
                                You should see a <code>Setup is complete!</code> message once everything is complete.
                            </li>
                            <br>
                        </ol>
                        This is it, finally Windows is somewhat easier than Mac machines. Your setup is done and you can move on to running a local 
                        server on your computer.
                        <br><br>
                        <b>Note that you only need to do the configuration once!</b>
                    </p>
                </section>
            </section>

            <section id="local-server-run-body"><h1>Run, Stop, and Update a Local Server</h1>
                <p>
                    Now that the software is on your computer, we can run a local server on your computer
                    to make Christofk_Grapha available for use.
                    <br><br>
                </p>

                <section id="local-server-run-mac">
                    <h3>Mac and Linux</h3>
                    <p>
                        <ol>
                            <li>
                                Go to <code>Desktop/Christofk_Grapha/scripts</code> folder.
                                <br>
                            </li>
                            <br>
                            <li>
                                Open <code>control_app_mac.command</code> file to launch the control script of Christofk_Grapha.
                                Due to MAC security features in newer OS, this might give you a security message. Try right-click on the 
                                <code>control_app_mac.command</code> file and click <code>Open</code>. You only need to right-click and 
                                <code>Open</code> once. Afterwards, your Mac will remember that this is a safe file.
                            </li>
                            <br>
                            <li>
                                Type <code>start</code> and press <code>Enter</code> to start a local server instance of Christofk_Grapha on your computer.
                                This step might take up to 20 seconds depending on the speed of your computer.
                            </li>
                            <br>
                            <li>
                                Once it says that <code>Dash is running on …</code>, you are good to go. The script will automatically open a new tab in your default browser to where you can use the app. 
                                You can go to <a href="http://127.0.0.1:8050/">http://127.0.0.1:8050/</a> to access the app on multiple tabs or if you close it.
                                <ul>
                                    <li>
                                        In your Terminal you might see messages describing an <code>error</code> or that <code>an Excel sheet could not be found</code>.
                                        You can ignore these as these are for troubleshooting purposes.
                                    </li>
                                </ul>
                            </li>
                            <br>
                            <li>
                                <b>This is very important!</b> Once you are done using the app, go back to your Terminal, type <code>stop</code> and press <code>Enter</code>.
                                This will stop the local server from running on your machine since this process requires a significant amount of resources to run.
                            </li>
                            <br>
                            <li>
                                If you executed the <code>stop</code> command and want to restart a local server for Christofk_Grapha on your computer
                                , you will need to open the <code>control_app_mac.command</code> file again which can be found in <code>Desktop/Christofk_Grapha/scripts</code> folder.
                            </li>
                            <br>
                            <li>
                                Please note that there are regular updates to Christofk_Grapha, therefore it is advisable to execute the <code>update</code> command once in a while.
                            </li>
                            <br>
                        </ol>
                    </p>
                </section>

                <section id="local-server-run-windows">
                    <h3>Windows</h3>
                    <p>
                        <ol>
                            <li>
                                Go to your <code>Desktop/Christofk_Grapha/scripts</code> folder and double click on the <code>control_app_windows.bat</code> file. 
                                    <ul>
                                        <li>If you receive a warning message, click on <code>More info</code> and on <code>Run anyway</code>.</li>
                                    </ul>
                            </li>
                            <br>
                            <li>
                                This opens the Windows batch file instance to control a local server for Christofk_Grapha.
                                Type <code>start</code> and press <code>Enter</code> to start the server on your computer.
                                This should open a <code>Python Launcher</code>> on your computer.
                            </li>
                            <br>
                            <li>
                                After 20 seconds at the most in your <code>Python Launcher</code>> you should see a message: 
                                <code>Dash is running on...</code>. This means that the local server was launched correctly 
                                and Christofk_Grapha is available for use. A new tab 
                            </li>
                            <br>
                            <li>
                                Go to <a href="http://127.0.0.1:8050/">http://127.0.0.1:8050/</a> to access the app on multiple tabs 
                                or if you accidentally close it while the local server is running.
                            </li>
                            <br>
                            <li>
                                After you are done using Christofk_Grapha, <b>please close the <code>Python Launcher</code> window</b>,
                                as it takes significant resources to run.
                            </li>
                            <br>
                            <li>
                                Please note that there are regular updates to Christofk_Grapha, therefore it is advisable to execute the <code>update</code> command once in a while
                                after launching <code>control_app_windows.bat</code>.
                            </li>
                            <br>
                            <li>
                                If you would like to use Christofk_Grapha again after closing, follow Step 1.
                            </li>
                        </ol>
                    </p>
                </section>
                

            </section>

            <section id="upload-data">
                <h1>Uploading Data</h1>
                <p>
                    Here is the description on the templates of the Excel files need to be uploaded to Christofk_Grapha.
                    The data can be metabolomics pool data, metabolomics isotopologue data and external variable data
                    that can be for linear regression with metabolomics data.
                    <br><br>
                    Click on or drag your Excel file to the <code>Drag and Drop Metabolomics Excel File or Select Files</code> box.
                    <br><br>
                    Only Excel <code>.xls or .xlsx</code> files are accepted. Christofk lab always checks if the analyzed
                    metabolomics data file is functioning with Christofk_Grapha. 
                    <br><br>
                    Also, please note that for functionality purposes, it is best to upload data that has not been normalized
                    directly in the Excel file.
                    <br><br>
                    You are welcome to add your own Excel sheets as long as they are not named 
                    <code>PoolAfterDF</code>, <code>Normalized</code> or <code>Lingress</code>.
                </p>
                <br>
                
                <section id="upload-data-pool">
                    <h3>Metabolomics Pool Data</h3>
                    <p>
                        Metabolomics pool data is mandatory for Christofk_Grapha to function. Isotopologue and external 
                        variable data is optional depending on your experimentation.
                        The program reads a sheet <code>PoolAfterDF</code> where the metabolomics pool data is located. 
                        In this sheet as well includes variables that are used for normalizing the pool data such
                        <code>trifluoromethanesulfonate</code> or <code>quantity/sample</code> (cell count, mg, etc.)
                        If you want to have additional normalization variable for the metabolomics data, please reach
                        out, so that we can help you with that.
                        <br><br>
                        Please check this file for looking at a template for a file with pool data: 
                        <a href="/christofkgrapha/example_data/data_pool_only.xlsx" download>data_pool_only.xlsx</a>
                        <br><br>
                    </p>
                </section>

                <section id="upload-data-iso">
                    <h3>Metabolomics Isotopologue Data</h3>
                    <p>
                        If you have Isotopologue Tracing in your experiment, the Excel file that is sent to you will include 
                        four Excel sheets: <code>Original Corrected Normalized PoolAfterDF</code>:
                        <br>
                        <code>Original</code> is for the metabolomics data before the correction for heavy isotopologue abundance.
                        <br>
                        <code>Corrected</code> is for the metabolomics data after the correction for heavy isotopologue abundance.
                        <br>
                        <code>Normalized</code> is for the metabolomics data after the correction for heavy isotopologue abundance that has 
                        been normalized from 0 to 1 for every metabolite.
                        <br>
                        <code>PoolAfterDF</code> is the metabolomics pool data.
                        <br><br>
                        Christofk_Grapha uses the <code>Normalized</code> sheet for visualizing the isotopologue data.
                        <br><br>
                        Please check this file for looking at a template for a file with isotopologue data: 
                        <a href="/christofkgrapha/example_data/data_w_isotopologues.xlsx" download>data_w_isotopologues.xlsx</a>
                        <br><br>
                    </p>
                </section>

                <section id="upload-data-lingress">
                    <h3>External Variable Data for Linear Regression with Metabolomics</h3>
                    <p>
                        If you have an External Variable that you would like to do linear regression with metabolomics pool data,
                        Christofk_Grapha will read an Excel sheet named <code>Lingress</code>. The 
                        <br><br>
                        Please check this file for looking at a template for a file with pool data:
                        <a href="/christofkgrapha/example_data/data_w_isotopologues_and_lingress.xlsx" download>data_w_isotopologues_and_lingress.xlsx</a>
                        <br><br>
                    </p>
                </section>
            </section>


            <section id="getting-started">
                <h1>Getting Started</h1>
                <p>
                    Once the data is uploaded, let's set the classes to be displayed, pool data normalization,
                    sample groups and order that will be used in the data visualization.
                </p>
                <br>
            
                <section id="getting-started-classes">
                    <h3>Metabolite Classes</h3>
                    <p>
                        You can select the metabolite classes that are to be displayed in your analysis graphs.
                        If you click on <code>Select Metabolite Classes to be Displayed</code>, this will bring up 
                        a pop up screen for selecting the classes. If you hover over
                        <i class="fa fa-info-circle"></i> image, it will display the metabolite names in the class.
                        Select as many classes as you would like to be displayed and click on <code>Update</code> button
                        for the selection to be saved.
                        <br>
                        <a href="/christofkgrapha/gifs/classes.gif"
                        
                    </p>
                    <br>
                </section>

                <section id="getting-started-normalization">
                    <h3>Pool Data Normalization</h3>
                    <p>
                        
                    </p>
                    <br>
                </section>

                <section id="getting-started-groups">
                    <h3>Sample Groups and Order</h3>
                    <p>
                        
                    </p>
                    <br>
                </section>

            </section>


            <section id="analysis-graphs">
                <h1>Analysis Graphs</h1>
                <p>
                    Content for Section 4...
                </p>
            


            </section>

        </div>
    </div>
</body>

<script>
    function toggleSections(selectedSectionId) {
        // Hide all sections
        var allSections = document.querySelectorAll('#content > section');
        allSections.forEach(section => {
            section.style.display = 'none';
        });

        // Show the clicked section
        var selectedSection = document.getElementById(selectedSectionId);
        if (selectedSection) {
            selectedSection.style.display = 'block';
            selectedSection.scrollIntoView({ behavior: 'smooth' });
        }
    }

    function toggleSubsections(subsectionId) {
        // First, hide all subsections in the sidebar
        var allSubsections = document.getElementsByClassName('sub-section');
        for (var i = 0; i < allSubsections.length; i++) {
            allSubsections[i].style.display = 'none';
        }

        // Then, show the subsections for the clicked main section
        var currentSubsections = document.getElementById(subsectionId);
        if (currentSubsections) {
            currentSubsections.style.display = 'block';
        }
    }

    // Display the Home section and its subsections (if any) on page load
    window.onload = function() {
        toggleSections('home');
        toggleSubsections('home-subsections');
    };
</script>

</html>

